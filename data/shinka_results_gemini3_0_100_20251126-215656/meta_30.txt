# INDIVIDUAL PROGRAM SUMMARIES

The following are summaries of individual programs evaluated since the last meta update:

**Program Name: Basic Least Recently Used (LRU) Algorithm**
- **Implementation**: The algorithm maintains a dictionary mapping cached keys to their last access count (logical timestamp), updating this value on every hit or insert and evicting the key with the oldest timestamp.
- **Performance**: The algorithm achieved a combined score of 0.21, with strong performance on traces exhibiting high temporal locality (up to 0.868) but failing on others.
- **Feedback**: This standard LRU implementation effectively captures recency but suffers significantly on scan-heavy or cyclic workloads (resulting in near-zero hit rates for many traces), suggesting the need for frequency-based or scan-resistant logic.
**Program Identifier:** Generation 0 - Patch Name initial_program - Correct Program: True

**Program Name: Hyperbolic Caching with Persistent Frequency History**
- **Implementation**: Calculates eviction scores as `Frequency / (CurrentTime - LastAccessTime)` to evict the lowest-scored item, while permanently retaining frequency counts for evicted keys to prioritize returning objects.
- **Performance**: Achieves a combined score of 0.23, with hit rates varying drastically from 0.00 to 0.88 depending on the workload trace.
- **Feedback**: While the approach balances recency and frequency, the O(N) linear scan for eviction is inefficient, and the algorithm struggles to adapt to scan-heavy or rapidly changing workloads.
**Program Identifier:** Generation 1 - Patch Name hyperbolic_caching_with_history - Correct Program: True

**Program Name: S3-FIFO Eviction with Ghost Registry**
- **Implementation**: Utilizes three `OrderedDict` structures to manage a small probationary FIFO, a main FIFO, and a ghost history, promoting items to the main queue based on access bits and prior eviction history.
- **Performance**: Achieved a combined score of 0.25, showing strong scan resistance on looping traces (up to 89% hit rate) but lower efficiency on highly random workloads.
- **Feedback**: The ghost registry effectively filters one-hit wonders by distinguishing frequency, though the static 10% allocation for the probationary queue may limit adaptability compared to dynamic resizing policies.
**Program Identifier:** Generation 2 - Patch Name s3_fifo_ghost - Correct Program: True

**Program Name: S3-FIFO Algorithm with Static Probation Partitioning**
- **Implementation**: Maintains `small` and `main` FIFO queues using ordered dictionaries, promoting items from the small queue (capped at 10% size) to main if accessed again based on frequency bits.
- **Performance**: Achieved a combined score of 0.23, with strong results on high-locality traces (up to 0.88) but poor handling of certain scan patterns (near 0.00).
- **Feedback**: The algorithm effectively segments items to protect the main cache from one-time accesses, though the fixed 10% probation size limits its responsiveness compared to adaptive queue sizing.
**Program Identifier:** Generation 3 - Patch Name s3fifo_v1 - Correct Program: True

**Program Name: Segmented LRU (SLRU) with Fixed 80% Protected Partition**
- **Implementation**: The algorithm divides the cache into a protected segment (80% capacity) and a probationary segment, promoting items to protected on hits and evicting the least recently used item from the probationary segment after handling demotions.
- **Performance**: It achieves a combined score of 0.23, performing well on specific high-locality workloads (up to 0.88 hit rate) but failing significantly on many others (often <0.05).
- **Feedback**: The SLRU logic effectively isolates popular items to improve hit rates on stable working sets, but the fixed partition ratio limits adaptability to changing access patterns compared to adaptive variants like ARC.
**Program Identifier:** Generation 4 - Patch Name slru_eviction - Correct Program: True

**Program Name: Adaptive Replacement Cache (ARC) with Dynamic Tuning**
- **Implementation**: The program implements the ARC algorithm using four `OrderedDict`s to separate recent (T1) and frequent (T2) items from their ghost entries, dynamically adjusting the target list size `p` based on ghost hits to balance eviction policies.
- **Performance**: The algorithm achieved a combined score of 0.24, with notable success on specific traces (up to 0.89 hit rate) but near-zero effectiveness on many others.
- **Feedback**: The implementation accurately captures ARC's adaptive logic, but the high variance in performance suggests that the standard learning rate for `p` may be too slow to adapt to the specific, rapidly changing patterns in this dataset.
**Program Identifier:** Generation 5 - Patch Name arc_eviction - Correct Program: True

**Program Name: Hyperbolic Frequency-Age-Size Score with Ghost Decay**
- **Implementation**: The algorithm selects eviction victims by minimizing a `Frequency / (Age * Size)` score, prioritizing the retention of frequently used, recently accessed, and small objects. It implements a ghost history mechanism where the frequency of evicted items is preserved but halved, allowing the cache to distinguish between one-hit wonders and recurring content.
- **Performance**: The algorithm achieves a combined score of 0.23, showing strong results on high-locality traces (e.g., Trace 28) but near-zero hit rates on scan-heavy or churning workloads.
- **Feedback**: While the hyperbolic formula successfully integrates multiple factors, the static weighting and aggressive eviction of new items (which start with zero frequency) make it brittle against workloads with shifting patterns or large working sets.
**Program Identifier:** Generation 6 - Patch Name probation_lfu_size_decay - Correct Program: True

**Program Name: Frequency-Age-Size Score Eviction with Decay**
- **Implementation**: The algorithm evicts items with the lowest score calculated as `Frequency / (Age * sqrt(Size))`, utilizing integer cross-multiplication for comparisons and decaying frequency upon eviction.
- **Performance**: Achieved a combined score of 0.22, exhibiting extreme variance with excellent rates on some traces (0.88) but near-zero on many others.
- **Feedback**: The heuristic effectively prioritizes small, frequent, and recent items in stable workloads but struggles significantly with scans or dynamic patterns where the age penalty causes premature eviction.
**Program Identifier:** Generation 7 - Patch Name improved_hyperbolic_size_aware - Correct Program: True

**Program Name: GDSF Variant with Frequency Decay**
- **Implementation**: Implements Greedy Dual Size Frequency (GDSF) using a linear scan, calculating priority as $L + Frequency/Size$ and updating the inflation value $L$ to the evicted item's score. It retains frequency history for evicted items, decaying values by half to balance recency and frequency.
- **Performance**: Achieved a combined score of 0.22, showing strong results on static frequency traces (e.g., 0.88) but failing near-completely on dynamic workloads.
- **Feedback**: The algorithm effectively identifies popular items in stable distributions but lacks responsiveness to shifting access patterns, likely due to the persistent frequency history overshadowing recency. Additionally, the $O(N)$ linear scan for eviction is computationally expensive for larger caches.
**Program Identifier:** Generation 8 - Patch Name gdsf_caching - Correct Program: True

**Program Name: S3-FIFO with Ghost Queue (S3-FIFO-D)**
- **Implementation**: Implements a three-queue structure (Small, Main, Ghost) where the Ghost queue tracks evicted probation items to promote them directly to Main upon re-access, bypassing the Small queue. It uses a static 10% target size for the Small queue and frequency counters to drive eviction and promotion decisions.
- **Performance**: Achieved a combined score of 0.25, demonstrating strong performance on high-locality traces (up to 0.89) but failing significantly on others (near 0.00).
- **Feedback**: While the Ghost queue logic aids in scan resistance and identifying recurring items, the static allocation for the Small queue limits the algorithm's ability to adapt to shifting workload phases compared to fully dynamic approaches.
**Program Identifier:** Generation 9 - Patch Name s3fifo_ghost - Correct Program: True

**Program Name: Adaptive S3-FIFO (A-S3-FIFO) with Ghost Registries**
- **Implementation**: This algorithm augments the standard S3-FIFO structure by dynamically adjusting the size ratio between the probationary (S) and protected (M) queues based on hits in ghost registries that track recently evicted items.
- **Performance**: The program achieved a combined score of 0.24, exhibiting high variance with excellent performance on some traces (e.g., 0.89) but failing near-completely on others.
- **Feedback**: While the adaptive mechanism attempts to optimize queue allocation, the low overall score and inconsistency suggest that the adaptation logic (step size or ghost hit interpretation) may be unstable or slow to react to rapidly changing access patterns compared to static configurations.
**Program Identifier:** Generation 10 - Patch Name adaptive_s3_fifo - Correct Program: True

**Program Name: Adaptive S3-FIFO with Ghost-Based Resizing**
- **Implementation**: This algorithm integrates S3-FIFO's probationary and main queues with ARC-style ghost lists, dynamically adjusting the probationary queue size based on hits in the ghost registries to balance frequency and recency.
- **Performance**: The approach yields a combined score of 0.23, exhibiting extreme variance with excellent hit rates on some traces (up to 0.89) but failing completely on others (<0.05).
- **Feedback**: While the adaptive mechanism attempts to optimize queue allocation, the high variance suggests the adaptation logic (step size or convergence speed) is unstable across diverse workloads compared to simpler static implementations.
**Program Identifier:** Generation 11 - Patch Name strict_promotion_and_extended_ghosts - Correct Program: True

**Program Name: Byte-Aware S3-FIFO Eviction with Ghost Registry**
- **Implementation**: The solution implements S3-FIFO using a Small (probation) and Main queue, controlling the Small queue size via a 10% byte-capacity limit rather than item count. It features a ghost registry for rescuing evicted items and uses access bits for lazy promotion and second-chance retention.
- **Performance**: The algorithm achieves a combined score of 0.23, showing high efficiency on select traces (up to 0.88 hit rate) but poor results on many others.
- **Feedback**: While the byte-aware tracking adds precision, the static 10% threshold for the probation queue appears too restrictive for certain workloads, causing high variance and thrashing in traces where a larger initial buffer or adaptive sizing would be beneficial.
**Program Identifier:** Generation 12 - Patch Name s3fifo_byte_aware - Correct Program: True

**Program Name: S3-FIFO with Ghost Queue and Main-to-Small Demotion**
- **Implementation**: Implements an S3-FIFO variant using probationary (Small) and protected (Main) queues, where unreferenced items in Main are demoted to Small rather than immediately evicted. A ghost queue tracks recently evicted Small items to bypass probation upon re-entry.
- **Performance**: Achieved a combined score of 0.25, performing well on some workloads (up to 89%) but failing significantly on many others (near 0%).
- **Feedback**: The demotion strategy likely extends object lifetime excessively for scan patterns, causing the probationary queue to clog and degrading performance on high-churn traces compared to standard eviction logic.
**Program Identifier:** Generation 13 - Patch Name S3-FIFO-Demotion - Correct Program: True

**Program Name: Adaptive Byte-Aware S3-FIFO with Ghost Queue Sizing**
- **Implementation**: This solution maintains probation and protected queues using an ARC-inspired adaptive ratio adjusted by hits in ghost registries, alongside byte-level capacity tracking and lazy promotion via access bits.
- **Performance**: The program achieved a score of 0.23, with high variability showing strong performance on static-friendly traces but near-zero hit rates on many others.
- **Feedback**: The addition of ARC-style dynamic resizing to S3-FIFO adds complexity that appears to destabilize performance on specific traces, though the byte-awareness correctly handles variable-sized objects.
**Program Identifier:** Generation 14 - Patch Name adaptive_s3_fifo - Correct Program: True

**Program Name: S3-LRU Hybrid with Ghost Queue and Lazy Promotion**
- **Implementation**: This algorithm employs a small FIFO queue with second-chance promotion to filter one-time accesses and a main LRU queue for popular items, utilizing a ghost queue to fast-track returning evictions into the main cache.
- **Performance**: The approach achieved a combined score of 0.25, performing exceptionally well on recency-heavy traces (0.89 hit rate) but struggling with scan-heavy workloads where hit rates dropped near zero.
- **Feedback**: The static 10% allocation for the small queue appears insufficient for specific access patterns; implementing adaptive queue sizing to dynamically adjust the balance between recency and frequency would likely improve stability across diverse traces.
**Program Identifier:** Generation 15 - Patch Name s3_lru_hybrid - Correct Program: True

**Program Name: Dynamic S3-FIFO with ARC-like Adaptive Sizing**
- **Implementation**: This algorithm maintains Small and Main FIFO queues with ghost registries, dynamically adjusting the Small queue's target size based on ghost hits to automatically balance recency and frequency. It employs a second-chance mechanism using access bits for promotion from Small to Main upon eviction and reinsertion within Main.
- **Performance**: The approach achieved a combined score of 0.23, demonstrating high hit rates on specific traces (up to 0.89) but near-zero performance on many others.
- **Feedback**: While the adaptive partitioning mechanism effectively captures working sets for some patterns, the high variance suggests the resizing logic or eviction priority may be unstable or slow to converge on workloads with rapid phase changes or scan patterns.
**Program Identifier:** Generation 16 - Patch Name dyns3fifo - Correct Program: True

**Program Name: S3-FIFO with Static Split and Ghost Registry**
- **Implementation**: Implements the S3-FIFO algorithm using a 10% capacity Small queue for insertions and a Main queue for promoted items, leveraging a ghost registry to identify and promote recurring items upon re-access.
- **Performance**: Achieved a combined score of 0.24, demonstrating high effectiveness on specific workloads (hit rates > 0.7) but poor performance on the majority of traces.
- **Feedback**: The ghost registry effectively filters "one-hit wonders" to protect the main cache, but the fixed 90/10 split between Main and Small queues likely limits adaptability across diverse access patterns compared to adaptive segmentation.
**Program Identifier:** Generation 17 - Patch Name implement_s3_fifo - Correct Program: True

**Program Name: S3-FIFO with Ghost Registry and Queue Demotion**
- **Implementation**: Implements S3-FIFO using a 10% probationary queue, a main queue, and a ghost registry, where unaccessed items from the main queue are demoted back to the probationary queue instead of being evicted.
- **Performance**: Achieved a combined score of 0.25, performing well on high-locality traces but suffering near-zero hit rates on several dynamic workloads.
- **Feedback**: The decision to recycle unaccessed main queue items back to the probationary queue creates a circular flow that likely retains cold data too long, undermining the algorithm's scan resistance and eviction efficiency.
**Program Identifier:** Generation 18 - Patch Name extended_ghost_and_demotion - Correct Program: True

**Program Name: Adaptive S3-LRU with Ghost Queue Sizing**
- **Implementation**: This hybrid algorithm combines S3-FIFO's probation queue and lazy promotion with an LRU protected region, utilizing ARC-style ghost queues to dynamically adjust the partition size based on eviction history.
- **Performance**: The algorithm achieved a combined score of 0.23, delivering high hit rates on specific traces (up to 0.89) but failing to capture patterns in others.
- **Feedback**: While the adaptive resizing aims to balance scan resistance and recency, the significant performance variance suggests the adaptation logic may be unstable or slow to converge on optimal configurations for certain workloads.
**Program Identifier:** Generation 19 - Patch Name adaptive_s3_lru_ghost - Correct Program: True

**Program Name: Adaptive S3-FIFO with Ghost Queue**
- **Implementation**: This algorithm extends S3-FIFO by incorporating a ghost queue to track evicted probation items and dynamically adjusts the ratio between the small and main queues based on hit patterns. It also implements a conditional demotion strategy where items evicted from the main queue are moved to the small queue if space permits.
- **Performance**: The program achieves a combined score of 0.23, with excellent hit rates on specific traces (up to 0.89) but near-zero performance on others.
- **Feedback**: While the adaptive resizing and ghost queue allow the cache to adjust to varying working set sizes, the extreme variance in performance suggests the adaptation logic or demotion strategy may be unstable or counterproductive for certain access patterns.
**Program Identifier:** Generation 20 - Patch Name adaptive_s3_fifo - Correct Program: True

**Program Name: Adaptive S3-LRU Hybrid with Ghost Queue Resizing**
- **Implementation**: Utilizes a small FIFO queue with second-chance promotion to filter one-time accesses and a main LRU queue for hot items, dynamically adjusting the size ratio based on ghost queue hits.
- **Performance**: Achieved a combined hit rate score of 0.23, performing exceptionally well on specific traces (0.89) while failing on others.
- **Feedback**: The ghost-based adaptive resizing effectively balances recency and frequency for stable workloads, though the incremental adjustment step may be too slow for highly volatile traces.
**Program Identifier:** Generation 21 - Patch Name adaptive_s3_lru_dual_ghost - Correct Program: True

**Program Name: Dynamic S3-FIFO with Adaptive Sizing and Frequency Gating**
- **Implementation**: Utilizes Small and Main queues with ghost registries to dynamically adjust partition sizes and restricts promotion to Main based on global access frequency counts.
- **Performance**: The algorithm achieved a combined score of 0.23, showing high variance with excellent hit rates on some traces but failing completely on others.
- **Feedback**: The adaptive sizing benefits locality-heavy workloads, but the strict frequency gating and S-queue capacity limit likely cause thrashing on scan-heavy or looping access patterns.
**Program Identifier:** Generation 22 - Patch Name freq_gating_and_s_cap - Correct Program: True

**Program Name: S3-FIFO with Frequency Decay and Large Ghost Queue**
- **Implementation**: Utilizes a probationary Small queue, a protected Main queue with frequency-based decay (demoting to Small), and an enlarged Ghost queue (20x capacity) to facilitate promotion.
- **Performance**: Achieves a combined score of 0.23, exhibiting high variance with hit rates ranging from 0.89 on optimal traces to 0.00 on others.
- **Feedback**: While the large ghost queue and frequency decay successfully capture long loops and repeated access patterns, the specific demotion logic results in zero hit rates on several traces, indicating significant robustness issues.
**Program Identifier:** Generation 23 - Patch Name s3_fifo_decay_ghost - Correct Program: True

**Program Name: Adaptive S3-FIFO with Demotion and Ghost Registry**
- **Implementation**: Utilizes a two-queue system where victims from the protected queue are demoted to the probationary queue, while probationary evictions populate a ghost registry that dynamically adjusts the partition size.
- **Performance**: Achieved a combined score of 0.22, showing high efficacy on repetitive loops but failing significantly on volatile, scan-heavy workloads.
- **Feedback**: The demotion strategy creates a useful recirculating buffer for stable working sets, but the adaptive sizing mechanism is likely biased or slow to converge, causing the probationary queue to thrash during phase changes.
**Program Identifier:** Generation 24 - Patch Name adaptive_s3fifo_v2 - Correct Program: True

**Program Name: Dynamic S3-FIFO with ARC-like Partitioning**
- **Implementation**: Maintains Small and Main FIFO queues with ghost registries to dynamically adjust partition ratios based on marginal utility (ghost hits), similar to ARC. It incorporates size-gating to evict large items immediately and demotes unaccessed Main items to the Small queue rather than evicting them directly.
- **Performance**: The approach yields a combined score of 0.22, excelling on specific workloads (up to 0.88 hit rate) but failing significantly on most others (<0.05).
- **Feedback**: While the dynamic sizing and ghost registries provide adaptability for stable working sets, the complex item demotion logic and reliance on heuristic global state resets likely cause instability and poor generalization across diverse traces.
**Program Identifier:** Generation 25 - Patch Name evict_demotion_sizegating - Correct Program: True

**Program Name: S3-FIFO with Probation Hysteresis and Ghost Registry**
- **Implementation**: Uses a split-queue architecture (Small 10%, Main 90%) with a ghost registry for history-based promotion and a strict probation mechanism requiring two hits in the Small queue for promotion to Main.
- **Performance**: Achieved a combined score of 0.25, with strong results on static workloads (up to 89% hit rate) but near-zero performance on several specific trace patterns.
- **Feedback**: The strict "two-hit" requirement within the small queue likely acts as an overly aggressive filter, preventing legitimate working sets from stabilizing in the Main queue before being evicted, causing thrashing on dynamic workloads.
**Program Identifier:** Generation 26 - Patch Name optimize_s3_fifo_hysteresis - Correct Program: True

**Program Name: S3-FIFO-D with Ghost Cache and Demotion Logic**
- **Implementation**: Implements a segmented FIFO (Small/Main) where items demote from Main to Small based on frequency counters (capped at 3), utilizing a ghost cache to promote re-accessed evicted items directly to Main with boosted priority.
- **Performance**: Achieved a combined score of 0.25, showing strong results on static high-locality traces (up to 0.89) but failing significantly on scan or loop patterns (near 0.00).
- **Feedback**: The demotion mechanism effectively retains hot content, but the lack of adaptive queue sizing and rigid frequency resets leads to thrashing in dynamic or large working-set scenarios.
**Program Identifier:** Generation 27 - Patch Name s3_fifo_demotion_ghost_persistence - Correct Program: True

**Program Name: Adaptive S3-FIFO with Ghost Queue Resizing**
- **Implementation**: Implements a two-queue S3-FIFO structure where the ratio between probationary and protected queues is dynamically adjusted based on hits in ghost registries, utilizing a second-chance mechanism for promotion.
- **Performance**: Achieves a combined score of 0.23, showing strong results on frequency-biased workloads (up to 0.89) but poor performance on scan-heavy traces.
- **Feedback**: While the adaptive resizing effectively captures high-frequency items, the near-zero scores on many traces suggest the algorithm struggles to filter one-time access patterns or adapt quickly enough to shifting workload phases.
**Program Identifier:** Generation 28 - Patch Name as3fifo_v2 - Correct Program: True

**Program Name: Hyper S3-FIFO with Dual Ghost Queues and Adaptive Sizing**
- **Implementation**: Manages a probationary (S) and protected (M) queue, dynamically adjusting the partition ratio based on ghost hits, and demotes M-evictions to S to filter warm items.
- **Performance**: Achieved a combined score of 0.23, with high hit rates on selected traces (e.g., 0.89) but near-zero performance on several others.
- **Feedback**: The ghost-based adaptive sizing effectively balances recency and frequency for some patterns, but the extreme low scores indicate the adaptation logic or queue management is unstable or slow to react on certain workloads.
**Program Identifier:** Generation 29 - Patch Name hyper_s3_fifo - Correct Program: True

# GLOBAL INSIGHTS SCRATCHPAD

The following are global insights about optimization approaches and their effectiveness:

Based on the analysis of the individual program summaries (Generations 20-29) and the implementation of the current best program (Generation 27), here are the extracted optimization insights.

## Successful Algorithmic Patterns
- **Static Queue Partitioning (90/10 Split)**: A fixed partition strategy (10% Small / 90% Main) utilized by the top-performing programs (Gen 26 and Gen 27, Score 0.25) consistently outperformed all adaptive resizing variants (Gen 20, 21, 24, 25, 28, 29, Scores 0.22–0.23). The stability of a guaranteed protected region proved superior to dynamic adjustments, which often failed to converge quickly enough on this dataset.
- **Main-to-Probation Demotion (Recycling)**: The current best program (Gen 27) implements a demotion policy where unaccessed items evicted from the Main queue are not discarded but moved to the tail of the Small queue. This "second chance" in probation allows the algorithm to retain items that are just slightly outside the current working set, contributing to the high score of 0.25.
- **Strict Probationary Filtering**: Both top performers employed aggressive filtering to protect the Main queue. Gen 27 uses demotion to recycle items back to probation, while Gen 26 required two hits in the Small queue for promotion. Both approaches achieved the top score (0.25), confirming that raising the barrier for entry into the protected queue is critical for performance.
- **Ghost-Triggered Bypass**: The successful implementation (Gen 27) uses the ghost registry strictly to bypass the probation queue. If a new item is found in the ghost registry, it is promoted directly to Main. This effectively distinguishes recurring patterns (which need protection) from one-time scans (which are filtered by Small).

## Ineffective Approaches
- **Adaptive/Dynamic Queue Resizing**: Across multiple generations (Gen 20, 21, 24, 25, 28, 29), algorithms that attempted to dynamically adjust the ratio between Small and Main queues based on ghost hits consistently stagnated at a score of 0.23. Feedback indicates that the adaptation logic was often too slow or unstable for the rapid phase changes in these traces.
- **Complex Frequency Gating**: Approaches that relied on global frequency counts or complex gating logic (Gen 22) failed to improve robustness (Score 0.23). The added complexity of tracking global state did not yield better results than the simpler, localized frequency counters (capped at small integers) used in the best program.
- **Circular Recycling in Heavy Scans**: While the demotion strategy improved the overall score, the evaluation of Gen 27 reveals it caused hit rates to drop to near zero on scan-heavy traces (Traces 14–19). The recycling of cold data from Main back to Small likely clogged the probation queue, preventing new content from entering during high-churn phases.

## Implementation Insights
- **Lazy Demotion Logic**: The current best program handles demotion within the eviction loop. When an item is selected for eviction from `_s3_main`, if it has zero frequency, it is moved to `_s3_small` (`_s3_main.pop(c); _s3_small[c] = None`) rather than being removed from the cache. This effectively offloads the final eviction decision to the Small queue's logic.
- **Extended Ghost Capacity**: The best code explicitly sets the ghost registry capacity to `2x` the cache size (`if len(_s3_ghost) > cache_snapshot.capacity * 2`). This larger history window is crucial for capturing looping patterns that slightly exceed the cache capacity, which a standard 1x ghost queue would miss.
- **Decoupled Frequency State**: The implementation uses a separate `_s3_freq` dictionary to track access counts (capped at 3). This separation allows access frequency to be maintained or reset independently of the item's location in the queues (e.g., resetting frequency to 0 upon demotion to Small), ensuring clean state transitions.
- **Conditional Eviction Order**: The `evict` function prioritizes the Small queue (`if len(_s3_small) > s_target`). It only examines the Main queue if the Small queue is within its target size. This enforces the static partitioning strictly while allowing the demotion flow to repopulate the Small queue naturally.

## Performance Analysis
- **Static vs. Adaptive Ceiling**: There is a clear performance ceiling for adaptive algorithms on this dataset. While static partition variants (Gen 26, 27) reached a score of 0.25, every attempt at adaptive sizing (Gen 20-25, 28, 29) failed to exceed 0.23. This suggests that the "learning" overhead or instability of adaptive methods outweighs their theoretical benefits for these specific workloads.
- **Polarized Performance Profile**: The current best program exhibits extreme variance. It achieves near-optimal hit rates on specific traces (0.89 on Trace 28, 0.83 on Trace 27) but fails completely on others (0.00 on Trace 14). This indicates the algorithm is highly specialized for "recency + frequency" patterns but lacks robustness against pure scan patterns.
- **Robustness of Filtering**: The tie for the top score (0.25) between Gen 26 (Hysteresis) and Gen 27 (Demotion) highlights that the exact mechanism of filtering (hit count vs. recycling) is less important than the architectural decision to make the Main queue exclusive. Both strategies successfully isolated the protected queue from cold data pollution.

# META RECOMMENDATIONS

The following are actionable recommendations for the next program generations:

Based on the analysis of the top-performing Generation 27 (Score 0.25) and the algorithmic insights gathered, here are 5 actionable recommendations for future mutations. These recommendations focus on mitigating the "scan intolerance" of the current best program (Trace 14: 0.00%) while preserving its excellent handling of recurring patterns.

1.  **Conditional Demotion Logic**
    The current program blindly recycles every zero-frequency victim from `_s3_main` back into `_s3_small`. This floods the probation queue with cold data during scans, causing the 0.00% hit rate on Trace 14. Modify `evict` to make demotion conditional: only move a victim from Main to Small if `_s3_small` is not currently full or if the global hit rate is stable. In all other cases (especially when Small is churning rapidly), evict the Main victim directly to keep the pipeline clear for new scan items.

2.  **Probationary Hysteresis (Two-Hit Promotion)**
    Combine the strengths of Gen 27 (Demotion) and Gen 26 (Hysteresis). Modify the promotion logic in `_s3_small` to require two hits instead of one to enter the protected `_s3_main` queue. On the first hit, simply move the item to the tail of `_s3_small` (renew probation). This higher barrier to entry prevents "one-hit wonders" and weak signals from polluting the large protected region, reserving it for truly high-frequency content.

3.  **Frequency-Aware Ghost Registry**
    Currently, the ghost registry treats all evicted items equally, allowing any returning ghost to bypass probation. Enhance `_s3_ghost` to store metadata (e.g., a "was_hot" boolean) indicating if the item was evicted from Main or Small. On a ghost hit, only bypass probation if the item was previously hot (from Main). If it was cold (from Small), re-insert it into `_s3_small`. This distinguishes valuable looping data from recurring low-value scans.

4.  **Probabilistic Admission (Scan Resistance)**
    To further protect against scan-heavy workloads where the cache is thrashing, implement a probabilistic admission policy. When the cache is full (specifically when `_s3_small` is full), admit new items with a probability $P < 1.0$ (e.g., 0.9). Randomly rejecting a small percentage of inserts during high pressure creates "breathing room" for existing items in the probation queue to accumulate hits, significantly improving robustness on traces like Trace 14.

5.  **Frequency Persistence on Demotion**
    Currently, when an item is demoted from Main to Small, its frequency is reset to 0, making it the immediate next victim in the Small queue if not accessed instantly. Modify the demotion step to initialize the item's frequency in `_s3_small` to 1 (or a "grace" value). This grants the demoted item one full cycle of protection in the probation queue, effectively implementing a "soft landing" that allows slightly cooling items a fair chance to be re-promoted before final eviction.